<div class="quiz-container owl-carousel">
  <form class="quiz-card" id="quiz-card-0">
    <h3 class="quiz-title">{{ module.title }}</h3>
    <p class="quiz-text">{{ module.welcome_text }}</p>
    <div class="quiz-nav-section">
      <button class="quiz-next-button" id="quiz-start">Get Started</button>
    </div>
  </form>

  {% for question in module.questions %}
    {% set card_num = loop.index %}
    <form class="quiz-card" id="quiz-card-{{ card_num }}">
      <h3 class="quiz-question">{{ question.question_text }}</h3>
      <div class="quiz-answer-section">
        {% if question.answer_type == "buttons" %}
          {% for answer in question.answers %}
            <button class="quiz-answer-button" id="quiz-answer-{{ card_num }}-{{ loop.index }}">
              {{ answer.answer_text }}
            </button>
            {% require_js %}
              <script>
                const nextCard = {% if answer.next_question %}{{ answer.next_question }}{% else %}{{ card_num + 1 }}{% endif %}
                $('#quiz-next-{{ card_num }}').click(function() {
                  $('.owl-carousel').trigger('to.owl.carousel', [nextCard])
                })
              </script>
            {% end_require_js %}
          {% endfor %}
        {% else if question.answer_type == "text" or question.answer_type == "number" or question.answer_type == "email" %}
          <input type="{{ question.answer_type }}" class="quiz-input" id="quiz-answer-{{ card_num }}">
        {% else %}
          <textarea class="quiz-input" id="quiz-answer-{{ card_num }}"></textarea>
        {% endif %}
      </div>
      <div class="quiz-nav-section">
        <button class="quiz-back-button" id="quiz-back-{{ card_num }}">Back</button>
        <button class="quiz-next-button quiz-hidden" id="quiz-next-{{ card_num }}">Next</button>
      </div>
    </form>
  {% endfor %}

  {% for result in module.results %}
    <form class="quiz-card" id="quiz-card-{{ module.questions|length + loop.index }}">
      <h3 class="quiz-title">{{ result.title }}</h3>
      <p class="quiz-text">{{ result.text }}</p>
    </form>
    <div class="quiz-nav-section">
      {% set href = result.button_link.url.href %}
      {% if result.button_link.url.type is equalto "EMAIL_ADDRESS" %}
         {% set href = "mailto:" + href %}
      {% endif %}
      <a class="quiz-next-button"
        href="{{ href }}"
        {% if result.button_link.open_in_new_tab %} target="_blank"{% endif %}
        {% if result.button_link.rel %} rel="{{ result.button_link.rel }}"{% endif %}
      >{{ result.button_text }}</button>
    </div>
  {% endfor %}
</div>

{% require_js %}
  <script>
    $(document).ready(function() {
      $('.owl-carousel').owlCarousel({
        items: 1,
        loop: false,
        mouseDrag: false,
        touchDrag: false,
        pullDrag: false,
        dots: false,
        animateIn: {% if module.slide_transition == "fade" %}"fadeIn"{% else %}false{% endif %},
        animateOut: {% if module.slide_transition == "fade" %}"fadeOut"{% else %}false{% endif %},
      })
    })
  </script>
{% end_require_js %}